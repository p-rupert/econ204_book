{"version":3,"kind":"Notebook","sha256":"68a1a378be2f15f94fdc2ca766dcdadd73023dfb60a8510b61fe153987062145","slug":"hp1","location":"/hp1.ipynb","dependencies":[],"frontmatter":{"title":"The HP Filter","content_includes_title":false,"kernelspec":{"name":"python3","display_name":"Python 3 (ipykernel)","language":"python"},"exports":[{"format":"ipynb","filename":"hp1.ipynb","url":"/hp1-607cc759185fcd668e7a256beb5f1f9a.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Smoothing time series data is useful in many economic situations. The main idea is to try to separate a “trend” from a “cycle.” The smoothed series should not differ too much from the actual data. This is done through a choice of parameters in the filter.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"go0IxE3dnN"}],"key":"kVbyf5yV0P"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Suppose we have ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"OGNOULvYWh"},{"type":"inlineMath","value":"T","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>T</mi></mrow><annotation encoding=\"application/x-tex\">T</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span></span></span></span>","key":"D4oe3t987Y"},{"type":"text","value":" observations on the log of some time series ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"dzqNpz9wdj"},{"type":"inlineMath","value":"y_{t}","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>y</mi><mi>t</mi></msub></mrow><annotation encoding=\"application/x-tex\">y_{t}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"b3MA8nY2nL"},{"type":"text","value":" for ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"zqcdS6GHKW"},{"type":"inlineMath","value":"t=1,2, \\ldots , T","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi><mo>=</mo><mn>1</mn><mo separator=\"true\">,</mo><mn>2</mn><mo separator=\"true\">,</mo><mo>…</mo><mo separator=\"true\">,</mo><mi>T</mi></mrow><annotation encoding=\"application/x-tex\">t=1,2, \\ldots , T</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">2</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">…</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span></span></span></span>","key":"qCVNHzbqch"},{"type":"text","value":", where ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"CEqGNN80rO"},{"type":"inlineMath","value":"y_{t}","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>y</mi><mi>t</mi></msub></mrow><annotation encoding=\"application/x-tex\">y_{t}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"q2RyS1Wybl"},{"type":"text","value":" consists of a trend term, ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"UhpXjvhfHP"},{"type":"inlineMath","value":"\\tau_{t}","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>τ</mi><mi>t</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\tau_{t}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.1132em;\">τ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:-0.1132em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"kAdPZe68RD"},{"type":"text","value":", and a cyclical component, ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"MiinoPKM6A"},{"type":"inlineMath","value":"c_{t}","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>c</mi><mi>t</mi></msub></mrow><annotation encoding=\"application/x-tex\">c_{t}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">c</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"MVhOZjFo1s"},{"type":"text","value":", so that ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"gIEo6WSVWC"},{"type":"inlineMath","value":"y_{t} = \\tau_{t} + c_{t}","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>y</mi><mi>t</mi></msub><mo>=</mo><msub><mi>τ</mi><mi>t</mi></msub><mo>+</mo><msub><mi>c</mi><mi>t</mi></msub></mrow><annotation encoding=\"application/x-tex\">y_{t} = \\tau_{t} + c_{t}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.1132em;\">τ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:-0.1132em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">c</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"z0CSlRl9aI"},{"type":"text","value":".","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"c6vbpmv6f3"}],"key":"t3SZ55ZAFS"},{"type":"paragraph","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"The HP filter finds ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"BNzkMKkVPU"},{"type":"inlineMath","value":"\\{\\tau_{t}\\}","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">{</mo><msub><mi>τ</mi><mi>t</mi></msub><mo stretchy=\"false\">}</mo></mrow><annotation encoding=\"application/x-tex\">\\{\\tau_{t}\\}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">{</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.1132em;\">τ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:-0.1132em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">}</span></span></span></span>","key":"LkifgsyjKa"},{"type":"text","value":" that solves","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"T5tGfdW5vp"}],"key":"sMIYKiJmec"},{"type":"math","value":"\\min_{\\tau} \\Big(\\sum_{t=1}^{T} (c)^2 + \\lambda \\sum_{t=1}^{T} [(\\tau_{t}-\\tau_{t-1})-(\\tau_{t-1}-\\tau_{t-2})]^2  \\Big),","position":{"start":{"line":8,"column":1},"end":{"line":10,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><munder><mrow><mi>min</mi><mo>⁡</mo></mrow><mi>τ</mi></munder><mo fence=\"false\" stretchy=\"true\" minsize=\"1.8em\" maxsize=\"1.8em\">(</mo><munderover><mo>∑</mo><mrow><mi>t</mi><mo>=</mo><mn>1</mn></mrow><mi>T</mi></munderover><mo stretchy=\"false\">(</mo><mi>c</mi><msup><mo stretchy=\"false\">)</mo><mn>2</mn></msup><mo>+</mo><mi>λ</mi><munderover><mo>∑</mo><mrow><mi>t</mi><mo>=</mo><mn>1</mn></mrow><mi>T</mi></munderover><mo stretchy=\"false\">[</mo><mo stretchy=\"false\">(</mo><msub><mi>τ</mi><mi>t</mi></msub><mo>−</mo><msub><mi>τ</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy=\"false\">)</mo><mo>−</mo><mo stretchy=\"false\">(</mo><msub><mi>τ</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>−</mo><msub><mi>τ</mi><mrow><mi>t</mi><mo>−</mo><mn>2</mn></mrow></msub><mo stretchy=\"false\">)</mo><msup><mo stretchy=\"false\">]</mo><mn>2</mn></msup><mo fence=\"false\" stretchy=\"true\" minsize=\"1.8em\" maxsize=\"1.8em\">)</mo><mo separator=\"true\">,</mo></mrow><annotation encoding=\"application/x-tex\">\\min_{\\tau} \\Big(\\sum_{t=1}^{T} (c)^2 + \\lambda \\sum_{t=1}^{T} [(\\tau_{t}-\\tau_{t-1})-(\\tau_{t-1}-\\tau_{t-2})]^2  \\Big),</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:3.0954em;vertical-align:-1.2671em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6679em;\"><span style=\"top:-2.4em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.1132em;\">τ</span></span></span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span><span class=\"mop\">min</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"delimsizing size2\">(</span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.8283em;\"><span style=\"top:-1.8829em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.05em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span><span style=\"top:-4.3em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.2671em;\"><span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">c</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:3.0954em;vertical-align:-1.2671em;\"></span><span class=\"mord mathnormal\">λ</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.8283em;\"><span style=\"top:-1.8829em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.05em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span><span style=\"top:-4.3em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.2671em;\"><span></span></span></span></span></span><span class=\"mopen\">[(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.1132em;\">τ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:-0.1132em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.1132em;\">τ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.1132em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.1132em;\">τ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.1132em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.8em;vertical-align:-0.65em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.1132em;\">τ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.1132em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">2</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mclose\"><span class=\"mclose\">]</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mord\"><span class=\"delimsizing size2\">)</span></span><span class=\"mpunct\">,</span></span></span></span></span>","enumerator":"1","key":"t9A7KvifFU"},{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"or, rewriting","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"bFm0PZKK36"}],"key":"qU1DziZWGi"},{"type":"math","value":"\\min_{\\tau} \\Big(\\sum_{t=1}^{T} (y_{t}-\\tau_{t})^2 + \\lambda \\sum_{t=1}^{T} [(\\tau_{t}-\\tau_{t-1})-(\\tau_{t-1}-\\tau_{t-2})]^2  \\Big),","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"tight":"before","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><munder><mrow><mi>min</mi><mo>⁡</mo></mrow><mi>τ</mi></munder><mo fence=\"false\" stretchy=\"true\" minsize=\"1.8em\" maxsize=\"1.8em\">(</mo><munderover><mo>∑</mo><mrow><mi>t</mi><mo>=</mo><mn>1</mn></mrow><mi>T</mi></munderover><mo stretchy=\"false\">(</mo><msub><mi>y</mi><mi>t</mi></msub><mo>−</mo><msub><mi>τ</mi><mi>t</mi></msub><msup><mo stretchy=\"false\">)</mo><mn>2</mn></msup><mo>+</mo><mi>λ</mi><munderover><mo>∑</mo><mrow><mi>t</mi><mo>=</mo><mn>1</mn></mrow><mi>T</mi></munderover><mo stretchy=\"false\">[</mo><mo stretchy=\"false\">(</mo><msub><mi>τ</mi><mi>t</mi></msub><mo>−</mo><msub><mi>τ</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy=\"false\">)</mo><mo>−</mo><mo stretchy=\"false\">(</mo><msub><mi>τ</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>−</mo><msub><mi>τ</mi><mrow><mi>t</mi><mo>−</mo><mn>2</mn></mrow></msub><mo stretchy=\"false\">)</mo><msup><mo stretchy=\"false\">]</mo><mn>2</mn></msup><mo fence=\"false\" stretchy=\"true\" minsize=\"1.8em\" maxsize=\"1.8em\">)</mo><mo separator=\"true\">,</mo></mrow><annotation encoding=\"application/x-tex\">\\min_{\\tau} \\Big(\\sum_{t=1}^{T} (y_{t}-\\tau_{t})^2 + \\lambda \\sum_{t=1}^{T} [(\\tau_{t}-\\tau_{t-1})-(\\tau_{t-1}-\\tau_{t-2})]^2  \\Big),</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:3.0954em;vertical-align:-1.2671em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6679em;\"><span style=\"top:-2.4em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.1132em;\">τ</span></span></span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span><span class=\"mop\">min</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"delimsizing size2\">(</span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.8283em;\"><span style=\"top:-1.8829em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.05em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span><span style=\"top:-4.3em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.2671em;\"><span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1141em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.1132em;\">τ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:-0.1132em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:3.0954em;vertical-align:-1.2671em;\"></span><span class=\"mord mathnormal\">λ</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.8283em;\"><span style=\"top:-1.8829em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.05em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span><span style=\"top:-4.3em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.2671em;\"><span></span></span></span></span></span><span class=\"mopen\">[(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.1132em;\">τ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:-0.1132em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.1132em;\">τ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.1132em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.1132em;\">τ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.1132em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.8em;vertical-align:-0.65em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.1132em;\">τ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.1132em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">2</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mclose\"><span class=\"mclose\">]</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mord\"><span class=\"delimsizing size2\">)</span></span><span class=\"mpunct\">,</span></span></span></span></span>","enumerator":"2","key":"SOjQ3TQIaa"},{"type":"paragraph","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"where ","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"Y0zY2IzNkg"},{"type":"inlineMath","value":"\\lambda","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>λ</mi></mrow><annotation encoding=\"application/x-tex\">\\lambda</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">λ</span></span></span></span>","key":"p7Nln9BLHY"},{"type":"text","value":" is the ``smoothness penalty.‘’ Note that as ","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"ivC0keMLR9"},{"type":"inlineMath","value":"\\lambda \\rightarrow 0","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>λ</mi><mo>→</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">\\lambda \\rightarrow 0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">λ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"ZrhQ8Epg03"},{"type":"text","value":", we just have the series, ","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"Lh9QBeqcew"},{"type":"inlineMath","value":"y_{t}","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>y</mi><mi>t</mi></msub></mrow><annotation encoding=\"application/x-tex\">y_{t}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"bA1eRBWvnz"},{"type":"text","value":", itself and ","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"PCCpluHWBn"},{"type":"inlineMath","value":"\\lambda \\rightarrow \\infty","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>λ</mi><mo>→</mo><mi mathvariant=\"normal\">∞</mi></mrow><annotation encoding=\"application/x-tex\">\\lambda \\rightarrow \\infty</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">λ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord\">∞</span></span></span></span>","key":"i2YvWqQI9c"},{"type":"text","value":" is just a regression on a linear trend (second difference is ","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"tNTR9wP4yS"},{"type":"text","value":"0","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"wDKY8tsPM0"},{"type":"text","value":"). Here is a Python implementation:","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"ymRlRLuqts"}],"key":"KgJgYMFI59"}],"key":"eGFM3zXNRN"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import numpy as np\nimport pandas as pd\nimport pandas_datareader as pdr\nimport datetime\nfrom statsmodels.tsa.filters.hp_filter import hpfilter\nimport matplotlib.pyplot as plt\nimport matplotlib as mpl\nfrom cycler import cycler\nfrom tabulate import tabulate\nfrom matplotlib.dates import DateFormatter\nfrom pandas.plotting import register_matplotlib_converters\nregister_matplotlib_converters\nimport matplotlib.ticker as ticker\n###from statsmodels.tsa.x13 import x13_arima_analysis\nimport sys\n### Some libraries for web scraping (BLS revisions)\nimport requests\nfrom bs4 import BeautifulSoup\nimport time\n\nstart_time = time.time()\n\npd.set_option('display.max_rows', None)\n\nmy_colors = [\"#00688b\",\n             \"#cd3333\",\n             \"#6c8b3d\", \n             \"cornflowerblue\",\n             \"#cd6600\",\n             \"#8b2323\",\n             \"#5d478b\",\n             \"red\"]\nplt.rcParams['axes.prop_cycle'] = cycler(color = my_colors)\nplt.rcParams['axes.spines.right'] = False\nplt.rcParams['axes.spines.top'] = False\nplt.rcParams['axes.xmargin'] = 0\n#plt.rcParams['axes.ymargin'] = 0.0\nplt.rcParams[\"figure.figsize\"] = (10.5,6.5)\nplt.rcParams['font.family'] = 'sans-serif'\nplt.rcParams['font.size'] = 14\nplt.rcParams['legend.fontsize'] = 'medium'\nplt.rcParams['legend.frameon'] = False\nplt.rcParams['legend.framealpha'] = None\nplt.rcParams[\"legend.loc\"] = 'best' \nplt.rcParams['axes.titlesize'] = 'xx-large'\nplt.rcParams['axes.titlecolor'] = '#3333B3FF'\nplt.rcParams['lines.linewidth'] = 3\n\nplt.rcParams['figure.subplot.left'] = 0\nplt.rcParams['figure.subplot.bottom'] = 0\nplt.rcParams['figure.subplot.right'] = 1\nplt.rcParams['figure.subplot.top'] = 1\n\ndef crosscorr(datax, datay, lag=0):\n   return datax.corr(datay.shift(lag))\n\ndef NBER(start_date):\n    ax2 = ax.twinx()\n    Recessions = monthly['recessiondates'][monthly.index >= start_date]\n    ax2.fill_between(Recessions.index,\n                     Recessions,\n                     step=\"pre\",\n                     color=\"gray\",\n                     alpha=0.2)\n    ax2.get_yaxis().set_visible(False)\n    return ax2\n\ndef simpleaxis(ax):\n    ax.spines['top'].set_visible(False)\n    ax.spines['right'].set_visible(False)\n    ax.get_xaxis().tick_bottom()\n    ax.get_yaxis().tick_left()\n\ndef day_format(label):\n    \"\"\"\n    Convert time label to the format of pandas line plot\n    \"\"\"\n    return f'{label.month} {label.day}'\n\ndef month_format(label):\n    \"\"\"\n    Convert time label to the format of pandas line plot\n    \"\"\"\n    month = label.month_name()[:3]\n    if month == 'Jan':\n        month = month + '\\n' + f'{label.year}'\n    #else:\n    #    month = \"\"\n    return month\n\ndef quarter_format(label):\n    \"\"\"\n    Convert time label to the format of pandas line plot\n    \"\"\"\n    month = label.month_name()[:3]\n    if month == 'Jan':\n        month = f'Q1\\n{label.year}'\n    if month == 'Apr':\n        month = 'Q2'\n    if month == 'Jul':\n        month = 'Q3'\n    if month == 'Oct':\n        month = 'Q4'\n    return month\n","key":"P6TeGV7soq"},{"type":"outputs","id":"NA07jpOU9cIE-_zmwgFmd","children":[],"key":"x5BI6EjjBp"}],"key":"RfZVgX9Qg4"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now we will read in some data.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"DwFXfYW2Kw"}],"key":"UVnOaqbXMP"}],"key":"wO6tqjm8ln"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"### Quarterly\n\nFREDmap = {\n    'GDPC1': 'real_gdp'\n    }\n\nquarterly = pdr.DataReader(list(FREDmap.keys()), 'fred', datetime.datetime(1800,1,1))\nquarterly.rename(columns = FREDmap, inplace = True)\n\nquarterly.to_pickle('quarterly.pickle')\n","key":"TXRAUagRp6"},{"type":"outputs","id":"4BMcHK2JwyJuxQ8TyeA25","children":[],"key":"OS2ZQRIrJg"}],"key":"ZMSAjzHDR9"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"quarterly['real_gdp'].tail()","key":"GhD6RiRUGO"},{"type":"outputs","id":"rSlIk0AKtwIOgr7R6kF7L","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":35,"metadata":{},"data":{"text/plain":{"content":"DATE\n2023-07-01    22780.933\n2023-10-01    22960.600\n2024-01-01    23053.545\n2024-04-01    23223.906\n2024-07-01    23386.733\nName: real_gdp, dtype: float64","content_type":"text/plain"}}},"children":[],"key":"ks2RQwZyvZ"}],"key":"l7RLon0vRu"}],"key":"O86Rxsg1mB"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def EconLineGraph(dataframe = None,\n                  series = None,\n                  labels = None,\n                  title = None,\n                  subtitle = None,\n                  source = None,\n                  ylabel = None,\n                  start_date = None,\n                  end_date = None,\n                  graph_name = None,\n                  recessions = False,\n                  logscale = False,\n                  ylines = None,\n                  yzero = False):\n   \"\"\"For creating line graphs from a data frame\n\n    Inputs:\n    -------\n    dataframe : dataframe\n         The dataframe containing the data to be plotted                           \n    series : vector of text\n         The \"names\" of the variables to be plotted\n    labels : vector of text\n         The labels (descriptions) of each variable\n    title : text string\n         Title for the figure\n    subtitle : text string\n         A \"title\" which appears at top left of the figure\n    source : text string\n         The source for the data; appears at bottom right of the figure\n    ylabel : text string\n         Text that appears beside the y axis\n    start_date : string\n         The first date to appear in the figure (end date is always the last available\n         observation). String as 'yyyy-mm-dd'.\n    graph_name : text string\n         The basename for the graph files. Both pdf and png files are produced\n    recessions : logical\n         If True, then include NBER business cycle recession shading from \n         the dataframe \"monthly\"\n    \"\"\"\n    \n   if start_date == None:\n      df = dataframe[series].dropna(how = 'all')\n      start_date = df.first_valid_index()\n   else:\n      df = dataframe.loc[start_date:][series].dropna(how = 'all')\n\n   fig, ax = plt.subplots()\n       \n   if logscale:\n      ax.set_yscale('log')\n      ax.yaxis.set_major_formatter(plt.FormatStrFormatter(\"%.0f\"))\n      ax.yaxis.set_minor_formatter(plt.FormatStrFormatter(\"%.0f\"))\n\n   if recessions:\n      ax.plot(df, clip_on = False)\n   else:\n      df.plot(ax = ax, clip_on = False)\n\n   if yzero is True:\n      plt.axhline(y = 0, color = '#a0a0a0', linewidth = 0.75, label = None)\n   else:\n      if ylines is not None:\n         if len(ylines) == 1:\n            df[str(ylines)] = ylines[0]\n            df[str(ylines)].loc[start_date:].plot(ax = ax, clip_on = False, color = '#a0a0a0', linewidth = 1.0)\n         else:\n            for i in ylines:\n               df[str(i)] = i\n               df[str(i)].loc[start_date:].plot(ax = ax, clip_on = False, color = '#a0a0a0', linewidth = 1.0)\n      \n   if title is not None:\n      ax.set_title(title)\n\n   if subtitle is not None:\n      ax.set_title(subtitle,\n                   loc = 'left',\n                   color = 'black',\n                   size = 'medium')\n\n   if ylabel is not None:\n      ax.set_ylabel(ylabel)\n\n   if labels is not None:\n      #if ax.get_legend() != None:\n      ax.legend(labels)\n      #ax.legend().set_zorder(2)\n   else:\n      if ax.get_legend() != None:\n         ax.legend().set_visible(False)\n\n   if source is not None:\n      ax.set_xlabel('Source: ' + source,\n                    horizontalalignment='right',\n                    x=1.0)\n   else:\n      ax.set_xlabel('')\n\n   if recessions:\n      ax2 = ax.twinx()\n      Recessions = monthly['recessiondates'][monthly.index >= start_date]\n      ax2.fill_between(Recessions.index,\n                       Recessions,\n                       step=\"pre\",\n                       color=\"gray\",\n                       alpha=.2)\n      ax2.get_yaxis().set_visible(False)\n      ax2.set_ymargin(0) \n\n   fig.savefig('pyfigs/pdf/' + graph_name + '.pdf', bbox_inches='tight', pad_inches=0.25)\n   fig.savefig('pyfigs/png/' + graph_name + '.png', bbox_inches='tight', pad_inches=0.25)\n   \n\n","key":"rVWwtuytWh"},{"type":"outputs","id":"esvbgPCiFlKuPJuIiZecS","children":[],"key":"gOVQD7Z5jm"}],"key":"wJY0sLoea7"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"EconLineGraph(dataframe = quarterly,\n              series = ['real_gdp'],\n              title = 'Real GDP\\n',\n              subtitle = 'Billions of Chained 2017 Dollars',\n              source = 'BEA',\n              start_date = '1947-01-01',\n              graph_name = 'log_real_gdp',\n              logscale= False)\n","key":"hep6nius3k"},{"type":"outputs","id":"dUC7P0iEpZIkPRlmjhOnD","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"6877796cdd2aa91f06ee13df07504525","path":"/6877796cdd2aa91f06ee13df07504525.png"},"text/plain":{"content":"<Figure size 1050x650 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"vug6QVroNA"}],"key":"ZY3Enp91HQ"}],"key":"nmm9EroKxs"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Take the log of real gdp and create the hpfilter, using 1600 for ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"NBjtd8XNw1"},{"type":"inlineMath","value":"\\lambda","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>λ</mi></mrow><annotation encoding=\"application/x-tex\">\\lambda</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">λ</span></span></span></span>","key":"eaLjl0mjHc"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"PtG1In4ofH"}],"key":"ulGS8Pk5Vv"}],"key":"BhrjoqIFlf"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"quarterly['lrgdp'] = np.log(quarterly['real_gdp'])\nhpcycle_gdp, hptrend_gdp = hpfilter(quarterly['lrgdp'].dropna(), lamb=1600)\nquarterly['hptrend_gdp'] = hptrend_gdp\nquarterly['hpcycle_gdp'] = hpcycle_gdp","key":"lPLM7QpoAk"},{"type":"outputs","id":"7eM73_2NtqY5nuAmvjRSV","children":[],"key":"FuQCiUrYc6"}],"key":"w77LrNOHjl"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now graph the real gdp series and the hp trend.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"NIze6Eewyz"}],"key":"xSZvut09L4"}],"key":"Zg2k0Kv860"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"EconLineGraph(dataframe = quarterly,\n          series = ['lrgdp', 'hptrend_gdp'],\n          labels = ['GDP', 'HP Trend'],\n          title = 'Real GDP and HP Trend\\n',\n          subtitle = 'Log of Trillions of 2017 Dollars',\n          source = 'BEA',\n          start_date = '1947-01-01',\n          graph_name = 'hp_log_real_gdp',\n          logscale= False)","key":"d8pmfPnIMO"},{"type":"outputs","id":"tzhkwzAo2qKDjwkvJk_1M","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"201615afa8971efff931389c7d9c6725","path":"/201615afa8971efff931389c7d9c6725.png"},"text/plain":{"content":"<Figure size 1050x650 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"FCewtPdgn0"}],"key":"TUhkv8LLT7"}],"key":"F2oaGLlzZG"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"","key":"pZfenB03Fw"},{"type":"outputs","id":"N3-fW_XJSoBJmHHADFSxg","children":[],"key":"Dn2RsfJ7sx"}],"key":"WVBDpLwCzJ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"EconLineGraph(dataframe = quarterly,\n          series = ['hpcycle_gdp'],\n          title = 'Real GDP Cyclical Component\\n',\n          subtitle = 'Log of Trillions of 2017 Dollars',\n          source = 'BEA',\n          start_date = '1947-01-01',\n          graph_name = 'hp_cycle_log_real_gdp',\n          yzero = True,\n          logscale= False)","key":"Q5lYOKn4GD"},{"type":"outputs","id":"GWpd0CzgK72ZaMRAaTWU_","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"bc2f5c993d18709ef12125cf68a5ae9d","path":"/bc2f5c993d18709ef12125cf68a5ae9d.png"},"text/plain":{"content":"<Figure size 1050x650 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"tBjx7yyd5X"}],"key":"eNX0wvYHlJ"}],"key":"dzusRU3KrT"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Homework #1:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"qTyABvk71t"}],"key":"AcHQqAyDSR"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"(A) Use a very large number for ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"UQA78KyTvw"},{"type":"inlineMath","value":"\\lambda","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>λ</mi></mrow><annotation encoding=\"application/x-tex\">\\lambda</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">λ</span></span></span></span>","key":"RwnUtEf0xs"},{"type":"text","value":", like 16000000000 and see the trend and cycle. Explain what is going on. Next plot the cylical component for the two different ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ZHXSHV5VUb"},{"type":"inlineMath","value":"\\lambda","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>λ</mi></mrow><annotation encoding=\"application/x-tex\">\\lambda</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">λ</span></span></span></span>","key":"hTSdEY2Hd0"},{"type":"text","value":"’s and comment on the difference.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"RWkzNwcyNW"}],"key":"sDyJfGygkk"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"(B) Download GDPCA from FRED. This is annual real GDP back to 1929. Should you use ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"Y8FzxbKgmK"},{"type":"inlineMath","value":"\\lambda=1600","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>λ</mi><mo>=</mo><mn>1600</mn></mrow><annotation encoding=\"application/x-tex\">\\lambda=1600</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">λ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1600</span></span></span></span>","key":"zLBNbw6qJk"},{"type":"text","value":"? Why or why not? If not, what value should you use? Why?","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"WygSmNxroR"}],"key":"IbmJ0I3Bdu"}],"key":"AIlTl7jnCS"}],"key":"CKPrpVDmNM"},"references":{"cite":{"order":[],"data":{}}}}